![image](https://github.com/user-attachments/assets/c2e71332-20ef-4147-a115-4d82b88c2e15)

**Question:** How do you create a database named `saturday` and switch to it for further operations?


```sql
-- 1. Create the 'saturday' database and switch to it
CREATE DATABASE saturday;
USE saturday;
```

**Explanation:** The script starts by creating a new database named `saturday` and then switches to that database using the `USE` command. This sets up the environment for further operations, ensuring that all subsequent queries are executed within this database.

**Question:** How do you create a `customer` table with specific columns and designate a primary key?

```sql
-- 2. Create the 'customer' table
CREATE TABLE customer (
    cID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    email VARCHAR(50),
    phoneNum VARCHAR(15)
);
```

**Explanation:** This query creates a `customer` table with five columns: `cID`, `FirstName`, `LastName`, `email`, and `phoneNum`. The `cID` column is defined as the primary key, ensuring that each customer has a unique identifier.

**Question:** How do you insert multiple customer records into the `customer` table with specific details like first name, last name, email, and phone number?

```sql
-- 3. Insert values into the 'customer' table
INSERT INTO customer VALUES
(1, 'amit', 'sharma', 'amit.sharma@example.com', '9876543210'),
(2, 'priya', 'mehta', 'priya.mehta@example.com', '8765432109'),
(3, 'rohit', 'kumar', 'rohit.kumar@example.com', '7654321098'),
(4, 'neha', 'verma', 'neha.verma@example.com', '6543210987'),
(5, 'siddharth', 'singh', 'siddharth.singh@example.com', '5432109876'),
(6, 'asha', 'rao', 'asha.rao@example.com', '4321098765');
```

**Explanation:** Six records are inserted into the `customer` table, each with values for `cID`, `FirstName`, `LastName`, `email`, and `phoneNum`. This populates the table with initial data for further querying.

**Question:** How would you standardize the formatting of first names and last names in the `customer` table by trimming any extra spaces and converting the text to lowercase?

```sql
-- 4. Standardize the formatting of first names and last names in the 'customer' table
UPDATE customer
SET FirstName = LTRIM(RTRIM(LOWER(FirstName))),
    LastName = LTRIM(RTRIM(LOWER(LastName)));
```

**Explanation:** This query standardizes the `FirstName` and `LastName` fields by trimming any leading and trailing spaces and converting all characters to lowercase. The `LTRIM` function removes leading spaces, `RTRIM` removes trailing spaces, and `LOWER` converts the text to lowercase.

**Explanation:** This query retrieves all records from the `customer` table where the `FirstName` starts with the letter 'A'. The `LIKE 'A%'` pattern matches any first name that begins with 'A', followed by any number of characters.

```sql
-- 5. Retrieve all records where the first name starts with the letter 'A'
SELECT * FROM customer
WHERE FirstName LIKE 'A%';
```

**Explanation:** This query retrieves all records from the `customer` table where the `FirstName` starts with the letter 'A'. The `LIKE 'A%'` pattern matches any first name that begins with 'A', followed by any number of characters.

**Question:** How can you select all customers from the `customer` table whose phone numbers consist of exactly 10 digits?

```sql
-- 6. Select all customers with 10-digit phone numbers
SELECT * FROM customer 
WHERE phoneNum LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]';
```

**Explanation:** This query selects all customers from the `customer` table whose phone numbers are exactly 10 digits long. The pattern `LIKE '[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'` matches a sequence of 10 digits.

**Question:** How can you find all customers in the `customer` table who have a last name that is exactly 5 characters long?

```sql
-- 7. Find customers with a last name that is exactly 5 characters long
SELECT * FROM customer 
WHERE LastName LIKE '_____'; -- underscore is 5 times
```

**Explanation:** This query finds all customers in the `customer` table who have a last name that is exactly 5 characters long. The pattern `LIKE '_____'` (five underscores) matches any last name with exactly five characters.

The table shared contains a `RunningTotal` column, which is cumulative sum of the `TotalAmount` for each `CustomerID`.

![image](https://github.com/user-attachments/assets/774f607e-b773-4837-833c-399dce9221d5)

```sql
SELECT 
    CustomerID,
    OrderID,
    TotalAmount,
    SUM(TotalAmount) OVER (PARTITION BY CustomerID ORDER BY OrderID) AS RunningTotal
FROM 
    Orders;
```

**Explanation:**
- `PARTITION BY CustomerID`: This partitions the data by `CustomerID`, ensuring that the running total is calculated separately for each customer.
- `ORDER BY OrderID`: This orders the rows within each partition (i.e., within each customer) by `OrderID` to calculate the running total in the correct sequence.
- `SUM(TotalAmount) OVER (...)`: This computes the cumulative sum of the `TotalAmount` as a running total for each customer. 

![image](https://github.com/user-attachments/assets/fa1c59e4-65af-457a-84b3-3a2e0230968e)

**Explanation:**
-It uses the RANK() window function to rank the customers by their total sales.
-The ORDER BY TotalSales DESC inside the RANK() function ranks the customers from highest to lowest sales. This rank is given the alias SalesRank.

This SQL query calculates the total sales for each customer, ranks them based on those sales in descending order, and displays the customer ID, total sales, and their rank. The ranking is done using the `RANK()` function. The results show customers ordered by their total sales, with the highest sales receiving the highest rank.

## RANK

## To use `RANK()`:

1. **Rank the Rows**:
   - Use `RANK() OVER (ORDER BY column_name DESC)` to rank rows based on a column, like sales, in descending order.
   
2. **Filter by Rank**:
   - To filter by rank (e.g., top 3), wrap the ranking in a subquery, then use `WHERE` in the outer query.

**Example:**
```sql
SELECT CustomerID, TotalSales, SalesRank
FROM (
    SELECT CustomerID, TotalSales,
           RANK() OVER (ORDER BY TotalSales DESC) AS SalesRank
    FROM SalesData
) AS RankedSales
WHERE SalesRank <= 3;
```

**Question:** What is the hierarchical structure of employees in the company, starting from the top-level managers down to their subordinates?"
![image](https://github.com/user-attachments/assets/4c8c5392-24d5-4e44-bd5b-fbbfc7c56001)
### Explanation in Simple Terms:


- **CTE (Common Table Expression):** A temporary result set that you can reference within a `SELECT`, `INSERT`, `UPDATE`, or `DELETE` statement. It makes your queries easier to read and manage.
## Anchor member/ base case
### What This Query Does:

1. **Start with Top-Level Employees:**
   - The query first finds employees who don't have a manager (their `ManagerID` is `NULL`). These are the top-level employees, like the CEO.

2. **Find Subordinates Recursively:**
   - It then uses a `UNION ALL` to repeatedly find employees who report to these top-level employees. This process continues until all levels of employees in the hierarchy are found.

3. **Show the Entire Hierarchy:**
   - Finally, the query selects everything from the CTE to display a full list of employees and their managers, showing the entire company hierarchy.

### Summary:
- The query builds a hierarchy of employees by starting from the top (no manager) and recursively finding who reports to whom. The result is a complete list of employees with their managers, organized by levels in the company.
- 
 ## ROLLUP
 
![image](https://github.com/user-attachments/assets/fe31ecb3-a22f-4e34-9887-149fe62b90e9)
![image](https://github.com/user-attachments/assets/054c80f4-173f-44b5-8933-f3d74379122e)

**ROLLUP** is a SQL feature that helps you quickly create totals and subtotals in your data. It's like an automatic calculator that adds up your numbers at different levels.

### How It Works:
Imagine you have a table showing sales by `Category` and `Product`, and you want to see:

1. Total sales for each product.
2. Total sales for each category (adding up all the products in that category).
3. A grand total for all sales.

Instead of writing separate queries, you can use `ROLLUP` to do it all at once.

### Example:
Hereâ€™s a basic query:

```sql
SELECT Category, Product, SUM(SalesAmount) AS TotalSales
FROM Sales
GROUP BY ROLLUP(Category, Product);
```

### What You Get:
This query will give you:

1. Sales for each product in every category.
2. A subtotal for each category.
3. A grand total for everything.

### Output Example:
| Category   | Product | TotalSales |
|------------|---------|------------|
| Electronics| TV      | 5000       |
| Electronics| Phone   | 3000       |
| Electronics| NULL    | 8000       |  -- Subtotal for Electronics
| Furniture  | Chair   | 2000       |
| Furniture  | Table   | 1500       |
| Furniture  | NULL    | 3500       |  -- Subtotal for Furniture
| NULL       | NULL    | 11500      |  -- Grand Total

### Key Points:
- **NULL** values in the result show where subtotals or the grand total are.
- **ROLLUP** saves you time by automatically calculating these totals.

## Co-related sub-query
![image](https://github.com/user-attachments/assets/af354dc6-8ba6-4eb4-800a-20ad154dbfdd)

**Question:** find customers who have placed more than one order. The query uses a subquery to count the number of orders for each customer.

### Explanation:
- **Main Query:** 
  ```sql
  SELECT DISTINCT o1.CustomerID
  FROM Orders2 o1
  WHERE (
      SELECT COUNT(*)
      FROM Orders2 o2
      WHERE o2.CustomerID = o1.CustomerID
  ) > 1;
  ```
  - `SELECT DISTINCT o1.CustomerID`: Selects unique customer IDs from the `Orders2` table.
  - `FROM Orders2 o1`: The query is run on the `Orders2` table, using an alias `o1`.
  - `WHERE`: This filters out customers with only one order.
    - The subquery counts the number of orders (`COUNT(*)`) for each customer (`o2.CustomerID = o1.CustomerID`).
    - It checks if this count is greater than 1.

### What the Query Does:
- The subquery calculates how many orders each customer has placed.
- The main query then filters and selects only those customers who have placed more than one order.

### Example Result:
- If a customer has placed two or more orders, their `CustomerID` will appear in the results.
- The image shows that `CustomerID` 1 and 2 have placed more than one order.

### Question:
*What SQL query could be used to find customers who have placed more than one order?*

**Answer:**
The SQL query provided is:

```sql
SELECT DISTINCT o1.CustomerID
FROM Orders2 o1
WHERE (
    SELECT COUNT(*)
    FROM Orders2 o2
    WHERE o2.CustomerID = o1.CustomerID
) > 1;
```

This query identifies customers in the `Orders2` table who have made more than one purchase.


